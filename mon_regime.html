<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¥— Mon RÃ©gime - Planificateur de Repas</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #10b981;
            --secondary: #3b82f6;
            --danger: #ef4444;
            --warning: #f59e0b;
            --purple: #8b5cf6;
            --dark: #1f2937;
            --light: #f3f4f6;
            --white: #ffffff;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--dark);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--white);
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .toolbar {
            display: flex;
            gap: 10px;
            padding: 20px 30px;
            background: var(--light);
            flex-wrap: wrap;
            align-items: center;
            border-bottom: 2px solid #e5e7eb;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 0.95em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--shadow);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-primary { background: var(--primary); color: white; }
        .btn-secondary { background: var(--secondary); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-warning { background: var(--warning); color: white; }
        .btn-purple { background: var(--purple); color: white; }
        .btn-small { padding: 8px 16px; font-size: 0.85em; }

        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 0;
            min-height: 600px;
        }

        .sidebar {
            background: #f9fafb;
            padding: 20px;
            border-right: 2px solid #e5e7eb;
            overflow-y: auto;
            max-height: 800px;
        }

        .sidebar h3 {
            margin-bottom: 15px;
            color: var(--dark);
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .search-box {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            margin-bottom: 15px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .search-box:focus {
            outline: none;
            border-color: var(--primary);
        }

        .category-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .category-btn {
            padding: 6px 12px;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.3s;
        }

        .category-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .aliment-item {
            background: white;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 10px;
            cursor: move;
            transition: all 0.3s;
            border: 2px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .aliment-item:hover {
            transform: translateX(5px);
            border-color: var(--primary);
            box-shadow: var(--shadow);
        }

        .aliment-item.in-stock {
            border-color: var(--primary);
            background: #d1fae5;
        }

        .aliment-item.in-wishlist {
            border-color: var(--purple);
            background: #ede9fe;
        }

        .aliment-item.dragging {
            opacity: 0.5;
        }

        .aliment-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .aliment-name {
            font-weight: 600;
            font-size: 0.95em;
        }

        .aliment-calories {
            color: #6b7280;
            font-size: 0.85em;
        }

        .stock-badge {
            background: var(--primary);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
        }

        .wishlist-badge {
            background: var(--purple);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
        }

        .calendar {
            padding: 30px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .day-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s;
        }

        .day-card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-5px);
        }

        .day-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            font-weight: 600;
            font-size: 1.1em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .day-total {
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9em;
        }

        .meal-section {
            padding: 15px;
            border-bottom: 1px solid #e5e7eb;
            position: relative;
        }

        .meal-section:last-child {
            border-bottom: none;
        }

        .meal-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .meal-calories {
            color: var(--primary);
            font-size: 0.9em;
        }

        .recipe-hint-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--purple);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s;
        }

        .recipe-hint-btn:hover {
            background: #7c3aed;
            transform: scale(1.05);
        }

        .drop-zone {
            min-height: 80px;
            border: 2px dashed #d1d5db;
            border-radius: 10px;
            padding: 10px;
            background: #f9fafb;
            transition: all 0.3s;
        }

        .drop-zone.drag-over {
            border-color: var(--primary);
            background: #d1fae5;
        }

        .meal-item {
            background: white;
            padding: 8px 12px;
            margin-bottom: 8px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #e5e7eb;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .meal-item-info {
            flex: 1;
        }

        .meal-item-name {
            font-weight: 500;
            font-size: 0.9em;
        }

        .meal-item-details {
            font-size: 0.8em;
            color: #6b7280;
        }

        .remove-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s;
        }

        .remove-btn:hover {
            background: #dc2626;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 900px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            color: var(--dark);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #6b7280;
            transition: color 0.3s;
        }

        .close-btn:hover {
            color: var(--danger);
        }

        .stock-list {
            display: grid;
            gap: 10px;
        }

        .stock-item {
            background: var(--light);
            padding: 12px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stock-item-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .add-stock-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .add-stock-form select,
        .add-stock-form input {
            padding: 10px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1em;
        }

        .add-stock-form select {
            flex: 1;
            min-width: 200px;
        }

        .add-stock-form input {
            width: 100px;
        }

        .shopping-list {
            list-style: none;
        }

        .shopping-item {
            padding: 12px;
            background: var(--light);
            margin-bottom: 8px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            opacity: 0.9;
        }

        .recipe-card {
            background: var(--light);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
            border: 2px solid #e5e7eb;
        }

        .recipe-card h4 {
            color: var(--dark);
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .recipe-meta {
            display: flex;
            gap: 15px;
            margin: 10px 0;
            color: #6b7280;
            flex-wrap: wrap;
        }

        .recipe-ingredients {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }

        .recipe-ingredients h5 {
            margin-bottom: 8px;
            color: var(--primary);
        }

        .recipe-steps {
            background: white;
            padding: 15px;
            border-radius: 10px;
        }

        .recipe-steps h5 {
            margin-bottom: 8px;
            color: var(--secondary);
        }

        .recipe-steps ol {
            padding-left: 20px;
        }

        .recipe-steps li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .recipe-tip {
            background: #fef3c7;
            border-left: 4px solid var(--warning);
            padding: 12px;
            margin-top: 10px;
            border-radius: 8px;
        }

        .recipe-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .recipe-suggestion {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .recipe-suggestion:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow);
            transform: translateY(-3px);
        }

        .recipe-suggestion h4 {
            color: var(--dark);
            margin-bottom: 8px;
        }

        .recipe-tags {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .recipe-tag {
            background: var(--light);
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            color: #6b7280;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .sidebar {
                max-height: 400px;
            }

            .calendar-grid {
                grid-template-columns: 1fr;
            }

            .toolbar {
                justify-content: center;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .btn {
                font-size: 0.85em;
                padding: 10px 16px;
            }

            .recipe-grid {
                grid-template-columns: 1fr;
            }
        }

        .empty-state {
            text-align: center;
            color: #9ca3af;
            padding: 20px;
            font-style: italic;
        }

        .batch-cooking-banner {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .batch-cooking-banner .icon {
            font-size: 2em;
        }

        .quick-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-chip {
            padding: 8px 16px;
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
        }

        .filter-chip:hover {
            border-color: var(--primary);
            background: #d1fae5;
        }

        .filter-chip.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
     </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¥— Mon RÃ©gime</h1>
            <p>Planifiez vos repas avec votre stock et vos envies</p>
        </div>

        <div class="toolbar">
            <button class="btn btn-purple" onclick="ouvrirStock()">ğŸ  Mon Stock</button>
            <button class="btn btn-purple" onclick="ouvrirEnvies()">ğŸ’­ Mes Envies</button>
            <button class="btn btn-primary" onclick="genererMenuEquilibre()">ğŸ² Menu Ã‰quilibrÃ©</button>
            <button class="btn btn-secondary" onclick="afficherListeCourses()">ğŸ›’ Liste de Courses</button>
            <button class="btn btn-warning" onclick="afficherStatistiques()">ğŸ“Š Statistiques</button>
            <button class="btn btn-purple" onclick="ouvrirRecettes()">ğŸ‘¨â€ğŸ³ IdÃ©es Recettes</button>
            <button class="btn btn-danger" onclick="reinitialiserMenus()">ğŸ§¹ RÃ©initialiser</button>
        </div>

        <div class="main-content">
            <div class="sidebar">
                <h3>ğŸ½ï¸ Aliments disponibles</h3>
                <input type="text" class="search-box" id="searchBox" placeholder="ğŸ” Rechercher un aliment..." onkeyup="filtrerAliments()">
                
                <div class="category-filter" id="categoryFilter"></div>
                
                <div id="alimentsList"></div>
            </div>

            <div class="calendar">
                <div class="calendar-grid" id="calendarGrid"></div>
            </div>
        </div>
    </div>

    <!-- Modal Stock -->
    <div class="modal" id="stockModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ  Mon Stock (Frigo & Placards)</h2>
                <button class="close-btn" onclick="fermerModal('stockModal')">Ã—</button>
            </div>
            
            <div class="add-stock-form">
                <select id="alimentStockSelect"></select>
                <input type="number" id="quantiteStock" placeholder="QuantitÃ©" value="1" min="1">
                <button class="btn btn-primary" onclick="ajouterAuStock()">+ Ajouter</button>
            </div>
            
            <div class="stock-list" id="stockList"></div>
        </div>
    </div>

    <!-- Modal Envies -->
    <div class="modal" id="enviesModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ’­ Mes Envies de la Semaine</h2>
                <button class="close-btn" onclick="fermerModal('enviesModal')">Ã—</button>
            </div>
            
            <div class="add-stock-form">
                <select id="alimentEnvieSelect"></select>
                <button class="btn btn-purple" onclick="ajouterAuxEnvies()">+ Ajouter</button>
            </div>
            
            <div class="stock-list" id="enviesList"></div>
        </div>
    </div>

    <!-- Modal Liste de Courses -->
    <div class="modal" id="shoppingModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ›’ Liste de Courses</h2>
                <button class="close-btn" onclick="fermerModal('shoppingModal')">Ã—</button>
            </div>
            <ul class="shopping-list" id="shoppingList"></ul>
            <button class="btn btn-primary" onclick="exporterPDF()" style="width: 100%; margin-top: 20px;">ğŸ“„ Exporter</button>
        </div>
    </div>

    <!-- Modal Statistiques -->
    <div class="modal" id="statsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ“Š Statistiques Nutritionnelles</h2>
                <button class="close-btn" onclick="fermerModal('statsModal')">Ã—</button>
            </div>
            <div class="stats-grid" id="statsGrid"></div>
            <div id="detailsStats"></div>
        </div>
    </div>

    <!-- Modal Recettes -->
    <div class="modal" id="recettesModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ‘¨â€ğŸ³ IdÃ©es de Recettes Pratiques</h2>
                <button class="close-btn" onclick="fermerModal('recettesModal')">Ã—</button>
            </div>

            <div class="batch-cooking-banner">
                <div class="icon">â±ï¸</div>
                <div>
                    <strong style="font-size: 1.1em;">Batch Cooking - Cuisinez Malin !</strong>
                    <p style="margin-top: 5px; opacity: 0.9;">PrÃ©parez plusieurs repas en une fois et gagnez du temps toute la semaine</p>
                </div>
            </div>

            <div class="quick-filters">
                <button class="filter-chip active" onclick="filtrerRecettes('tous')" data-filter="tous">ğŸ½ï¸ Toutes</button>
                <button class="filter-chip" onclick="filtrerRecettes('rapide')" data-filter="rapide">âš¡ Rapides (- 15min)</button>
                <button class="filter-chip" onclick="filtrerRecettes('facile')" data-filter="facile">ğŸ‘ Faciles</button>
                <button class="filter-chip" onclick="filtrerRecettes('batch')" data-filter="batch">â±ï¸ Batch Cooking</button>
                <button class="filter-chip" onclick="filtrerRecettes('economique')" data-filter="economique">ğŸ’° Ã‰conomiques</button>
            </div>

            <div id="recettesContent"></div>
        </div>
    </div>

    <!-- Modal DÃ©tail Recette -->
    <div class="modal" id="recetteDetailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="recetteDetailTitre"></h2>
                <button class="close-btn" onclick="fermerModal('recetteDetailModal')">Ã—</button>
            </div>
            <div id="recetteDetailContent"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
       const ALIMENTS = {
  "abricot": {emoji: "ğŸ‘", calories: 48, quantite: 100, unite: "g", categorie: "Fruits"},
  "agneau": {emoji: "ğŸ–", calories: 250, quantite: 100, unite: "g", categorie: "Viandes"},
  "ail": {emoji: "ğŸ§„", calories: 13, quantite: 10, unite: "g", categorie: "Aromates / Ã‰pices"},
  "amandes": {emoji: "ğŸŒ°", calories: 174, quantite: 30, unite: "g", categorie: "Fruits Ã  coque"},
  "ananas": {emoji: "ğŸ", calories: 75, quantite: 150, unite: "g", categorie: "Fruits"},
  "artichaut": {emoji: "ğŸŒ¿", calories: 71, quantite: 150, unite: "g", categorie: "LÃ©gumes"},
  "asperge": {emoji: "ğŸ¥¬", calories: 20, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "aubergine": {emoji: "ğŸ†", calories: 38, quantite: 150, unite: "g", categorie: "LÃ©gumes"},
  "avocat": {emoji: "ğŸ¥‘", calories: 160, quantite: 100, unite: "g", categorie: "Fruits"},
  "banane": {emoji: "ğŸŒ", calories: 89, quantite: 100, unite: "g", categorie: "Fruits"},
  "basilic": {emoji: "ğŸŒ¿", calories: 2, quantite: 10, unite: "g", categorie: "Aromates / Ã‰pices"},
  "betterave": {emoji: "ğŸ¥—", calories: 43, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "beurre": {emoji: "ğŸ§ˆ", calories: 72, quantite: 10, unite: "g", categorie: "MatiÃ¨res grasses"},
  "beurre de cacahuÃ¨te": {emoji: "ğŸ¥œ", calories: 118, quantite: 20, unite: "g", categorie: "MatiÃ¨res grasses"},
  "biscotte": {emoji: "ğŸ", calories: 38, quantite: 10, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "biscuit": {emoji: "ğŸª", calories: 135, quantite: 30, unite: "g", categorie: "Produits sucrÃ©s"},
  "blÃ©": {emoji: "ğŸŒ¾", calories: 204, quantite: 60, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "bÅ“uf": {emoji: "ğŸ¥©", calories: 250, quantite: 100, unite: "g", categorie: "Viandes"},
  "bonbon": {emoji: "ğŸ¬", calories: 20, quantite: 5, unite: "g", categorie: "Produits sucrÃ©s"},
  "boulgour": {emoji: "ğŸŒ¾", calories: 205, quantite: 60, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "brie": {emoji: "ğŸ§€", calories: 100, quantite: 30, unite: "g", categorie: "Produits laitiers"},
  "brioche": {emoji: "ğŸ¥", calories: 190, quantite: 50, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "brocoli": {emoji: "ğŸ¥¦", calories: 34, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "cabillaud": {emoji: "ğŸŸ", calories: 98, quantite: 120, unite: "g", categorie: "Poissons"},
  "cacahuÃ¨tes": {emoji: "ğŸ¥œ", calories: 170, quantite: 30, unite: "g", categorie: "Fruits Ã  coque"},
  "cafÃ©": {emoji: "â˜•", calories: 4, quantite: 200, unite: "ml", categorie: "Boissons"},
  "caille": {emoji: "ğŸ¦", calories: 134, quantite: 100, unite: "g", categorie: "Viandes"},
  "calamars": {emoji: "ğŸ¦‘", calories: 92, quantite: 100, unite: "g", categorie: "Poissons"},
  "camembert": {emoji: "ğŸ§€", calories: 87, quantite: 30, unite: "g", categorie: "Produits laitiers"},
  "canard": {emoji: "ğŸ¦†", calories: 190, quantite: 100, unite: "g", categorie: "Viandes"},
  "cannelle": {emoji: "ğŸ§‚", calories: 2, quantite: 1, unite: "g", categorie: "Aromates / Ã‰pices"},
  "cÃ¢pres": {emoji: "ğŸ«’", calories: 2, quantite: 10, unite: "g", categorie: "Condiments"},
  "carotte": {emoji: "ğŸ¥•", calories: 40, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "cassis": {emoji: "ğŸ«", calories: 63, quantite: 100, unite: "g", categorie: "Fruits"},
  "cÃ©leri branche": {emoji: "ğŸ¥¬", calories: 13, quantite: 80, unite: "g", categorie: "LÃ©gumes"},
  "cÃ©leri rave": {emoji: "ğŸ¥¬", calories: 42, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "cÃ©rÃ©ales petit-dÃ©jeuner": {emoji: "ğŸ¥£", calories: 113, quantite: 30, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "cerise": {emoji: "ğŸ’", calories: 50, quantite: 100, unite: "g", categorie: "Fruits"},
  "champignons": {emoji: "ğŸ„", calories: 22, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "chÃ¢taigne": {emoji: "ğŸŒ°", calories: 107, quantite: 50, unite: "g", categorie: "Fruits Ã  coque"},
  "cheddar": {emoji: "ğŸ§€", calories: 121, quantite: 30, unite: "g", categorie: "Produits laitiers"},
  "chicorÃ©e": {emoji: "ğŸ¥¬", calories: 14, quantite: 80, unite: "g", categorie: "LÃ©gumes"},
  "chips": {emoji: "ğŸŸ ", calories: 268, quantite: 50, unite: "g", categorie: "Snacks"},
  "chocolat au lait": {emoji: "ğŸ«", calories: 106, quantite: 20, unite: "g", categorie: "Produits sucrÃ©s"},
  "chocolat blanc": {emoji: "ğŸ«", calories: 108, quantite: 20, unite: "g", categorie: "Produits sucrÃ©s"},
  "chocolat noir": {emoji: "ğŸ«", calories: 109, quantite: 20, unite: "g", categorie: "Produits sucrÃ©s"},
  "chou blanc": {emoji: "ğŸ¥¬", calories: 25, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "chou de Bruxelles": {emoji: "ğŸ¥¬", calories: 45, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "chou rouge": {emoji: "ğŸ¥¬", calories: 30, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "chou-fleur": {emoji: "ğŸ¥¬", calories: 38, quantite: 150, unite: "g", categorie: "LÃ©gumes"},
  "ciboulette": {emoji: "ğŸŒ¿", calories: 2, quantite: 5, unite: "g", categorie: "Aromates / Ã‰pices"},
  "citron": {emoji: "ğŸ‹", calories: 17, quantite: 60, unite: "g", categorie: "Fruits"},
  "citrouille": {emoji: "ğŸƒ", calories: 39, quantite: 150, unite: "g", categorie: "LÃ©gumes"},
  "clÃ©mentine": {emoji: "ğŸŠ", calories: 38, quantite: 80, unite: "g", categorie: "Fruits"},
  "coca-cola": {emoji: "ğŸ¥¤", calories: 105, quantite: 250, unite: "ml", categorie: "Boissons"},
  "coco (noix de)": {emoji: "ğŸ¥¥", calories: 177, quantite: 50, unite: "g", categorie: "Fruits Ã  coque"},
  "colin": {emoji: "ğŸŸ", calories: 103, quantite: 120, unite: "g", categorie: "Poissons"},
  "compote": {emoji: "ğŸ", calories: 85, quantite: 100, unite: "g", categorie: "Produits sucrÃ©s"},
  "concombre": {emoji: "ğŸ¥’", calories: 12, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "confiture": {emoji: "ğŸ¯", calories: 50, quantite: 20, unite: "g", categorie: "Produits sucrÃ©s"},
  "coquillettes": {emoji: "ğŸ", calories: 280, quantite: 80, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "coriandre": {emoji: "ğŸŒ¿", calories: 2, quantite: 10, unite: "g", categorie: "Aromates / Ã‰pices"},
  "cornichon": {emoji: "ğŸ¥’", calories: 3, quantite: 30, unite: "g", categorie: "LÃ©gumes"},
  "cottage cheese": {emoji: "ğŸ§€", calories: 98, quantite: 100, unite: "g", categorie: "Produits laitiers"},
  "courgette": {emoji: "ğŸ¥’", calories: 26, quantite: 150, unite: "g", categorie: "LÃ©gumes"},
  "couscous": {emoji: "ğŸŒ¾", calories: 226, quantite: 60, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "crabe": {emoji: "ğŸ¦€", calories: 87, quantite: 100, unite: "g", categorie: "Poissons"},
  "crÃ¨me fraÃ®che": {emoji: "ğŸ¥›", calories: 90, quantite: 30, unite: "g", categorie: "MatiÃ¨res grasses"},
  "crÃ¨me glacÃ©e": {emoji: "ğŸ¨", calories: 207, quantite: 100, unite: "g", categorie: "Produits sucrÃ©s"},
  "cresson": {emoji: "ğŸ¥¬", calories: 6, quantite: 50, unite: "g", categorie: "LÃ©gumes"},
  "crevettes": {emoji: "ğŸ¦", calories: 90, quantite: 100, unite: "g", categorie: "Poissons"},
  "croissant": {emoji: "ğŸ¥", calories: 203, quantite: 50, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "cumin": {emoji: "ğŸŒ°", calories: 19, quantite: 5, unite: "g", categorie: "Aromates / Ã‰pices"},
  "curcuma": {emoji: "ğŸ§‚", calories: 3, quantite: 1, unite: "g", categorie: "Aromates / Ã‰pices"},
  "curry": {emoji: "ğŸŒ¶ï¸", calories: 16, quantite: 5, unite: "g", categorie: "Aromates / Ã‰pices"},
  "datte": {emoji: "ğŸ«˜", calories: 56, quantite: 20, unite: "g", categorie: "Fruits"},
  "dinde": {emoji: "ğŸ¦ƒ", calories: 210, quantite: 150, unite: "g", categorie: "Viandes"},
  "dorade": {emoji: "ğŸŸ", calories: 115, quantite: 120, unite: "g", categorie: "Poissons"},
  "eau": {emoji: "ğŸ’§", calories: 0, quantite: 250, unite: "ml", categorie: "Boissons"},
  "Ã©chalote": {emoji: "ğŸ§…", calories: 22, quantite: 30, unite: "g", categorie: "LÃ©gumes"},
  "Ã©crevisse": {emoji: "ğŸ¦", calories: 77, quantite: 100, unite: "g", categorie: "Poissons"},
  "emmental": {emoji: "ğŸ§€", calories: 114, quantite: 30, unite: "g", categorie: "Produits laitiers"},
  "endive": {emoji: "ğŸ¥¬", calories: 14, quantite: 80, unite: "g", categorie: "LÃ©gumes"},
  "Ã©peautre": {emoji: "ğŸŒ¾", calories: 203, quantite: 60, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "Ã©pinards": {emoji: "ğŸ¥¬", calories: 23, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "faisan": {emoji: "ğŸ¦", calories: 133, quantite: 100, unite: "g", categorie: "Viandes"},
  "farine": {emoji: "ğŸŒ¾", calories: 364, quantite: 100, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "farine complÃ¨te": {emoji: "ğŸŒ¾", calories: 332, quantite: 100, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "fenouil": {emoji: "ğŸŒ¿", calories: 31, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "feta": {emoji: "ğŸ§€", calories: 132, quantite: 50, unite: "g", categorie: "Produits laitiers"},
  "figue": {emoji: "ğŸˆ", calories: 37, quantite: 50, unite: "g", categorie: "Fruits"},
  "figue sÃ¨che": {emoji: "ğŸˆ", calories: 75, quantite: 30, unite: "g", categorie: "Fruits"},
  "flageolets": {emoji: "ğŸ«›", calories: 90, quantite: 100, unite: "g", categorie: "LÃ©gumineuses"},
  "flocons d'avoine": {emoji: "ğŸ¥£", calories: 152, quantite: 40, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "foie de veau": {emoji: "ğŸ–", calories: 140, quantite: 100, unite: "g", categorie: "Viandes"},
  "foie gras": {emoji: "ğŸ–", calories: 139, quantite: 30, unite: "g", categorie: "Viandes"},
  "fraise": {emoji: "ğŸ“", calories: 33, quantite: 100, unite: "g", categorie: "Fruits"},
  "framboise": {emoji: "ğŸ“", calories: 52, quantite: 100, unite: "g", categorie: "Fruits"},
  "frites": {emoji: "ğŸŸ", calories: 468, quantite: 150, unite: "g", categorie: "Plats prÃ©parÃ©s"},
  "fromage blanc": {emoji: "ğŸ¥›", calories: 75, quantite: 100, unite: "g", categorie: "Produits laitiers"},
  "fromage de chÃ¨vre": {emoji: "ğŸ§€", calories: 80, quantite: 30, unite: "g", categorie: "Produits laitiers"},
  "fruits de mer": {emoji: "ğŸ¦", calories: 85, quantite: 100, unite: "g", categorie: "Poissons"},
  "gÃ¢teau": {emoji: "ğŸ‚", calories: 350, quantite: 100, unite: "g", categorie: "Produits sucrÃ©s"},
  "gaufre": {emoji: "ğŸ§‡", calories: 218, quantite: 75, unite: "g", categorie: "Produits sucrÃ©s"},
  "gingembre": {emoji: "ğŸ«š", calories: 8, quantite: 10, unite: "g", categorie: "Aromates / Ã‰pices"},
  "gnocchi": {emoji: "ğŸ¥”", calories: 150, quantite: 150, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "gorgonzola": {emoji: "ğŸ§€", calories: 106, quantite: 30, unite: "g", categorie: "Produits laitiers"},
  "gouda": {emoji: "ğŸ§€", calories: 107, quantite: 30, unite: "g", categorie: "Produits laitiers"},
  "goyave": {emoji: "ğŸˆ", calories: 68, quantite: 100, unite: "g", categorie: "Fruits"},
  "granola": {emoji: "ğŸ¥£", calories: 188, quantite: 40, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "grenade": {emoji: "ğŸ", calories: 83, quantite: 100, unite: "g", categorie: "Fruits"},
  "groseille": {emoji: "ğŸ’", calories: 56, quantite: 100, unite: "g", categorie: "Fruits"},
  "gruyÃ¨re": {emoji: "ğŸ§€", calories: 124, quantite: 30, unite: "g", categorie: "Produits laitiers"},
  "hamburger": {emoji: "ğŸ”", calories: 443, quantite: 150, unite: "g", categorie: "Plats prÃ©parÃ©s"},
  "hareng": {emoji: "ğŸŸ", calories: 158, quantite: 100, unite: "g", categorie: "Poissons"},
  "haricot vert": {emoji: "ğŸ«›", calories: 31, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "haricots blancs": {emoji: "ğŸ«˜", calories: 266, quantite: 80, unite: "g", categorie: "LÃ©gumineuses"},
  "haricots rouges": {emoji: "ğŸ«˜", calories: 266, quantite: 80, unite: "g", categorie: "LÃ©gumineuses"},
  "homard": {emoji: "ğŸ¦", calories: 134, quantite: 150, unite: "g", categorie: "Poissons"},
  "huile d'olive": {emoji: "ğŸ«’", calories: 90, quantite: 10, unite: "ml", categorie: "MatiÃ¨res grasses"},
  "huile de coco": {emoji: "ğŸ¥¥", calories: 90, quantite: 10, unite: "ml", categorie: "MatiÃ¨res grasses"},
  "huile de tournesol": {emoji: "ğŸŒ»", calories: 90, quantite: 10, unite: "ml", categorie: "MatiÃ¨res grasses"},
  "huÃ®tres": {emoji: "ğŸ¦ª", calories: 69, quantite: 100, unite: "g", categorie: "Poissons"},
  "infusion": {emoji: "â˜•", calories: 2, quantite: 200, unite: "ml", categorie: "Boissons"},
  "jambon blanc": {emoji: "ğŸ¥“", calories: 58, quantite: 50, unite: "g", categorie: "Viandes"},
  "jambon cru": {emoji: "ğŸ¥“", calories: 48, quantite: 30, unite: "g", categorie: "Viandes"},
  "jus d'orange": {emoji: "ğŸ§ƒ", calories: 90, quantite: 200, unite: "ml", categorie: "Boissons"},
  "jus de pomme": {emoji: "ğŸ§ƒ", calories: 92, quantite: 200, unite: "ml", categorie: "Boissons"},
  "kaki": {emoji: "ğŸ‘", calories: 70, quantite: 100, unite: "g", categorie: "Fruits"},
  "kÃ©fir": {emoji: "ğŸ¥›", calories: 75, quantite: 125, unite: "g", categorie: "Produits laitiers"},
  "ketchup": {emoji: "ğŸ…", calories: 17, quantite: 15, unite: "g", categorie: "Condiments"},
  "kiwi": {emoji: "ğŸ¥", calories: 61, quantite: 100, unite: "g", categorie: "Fruits"},
  "lait demi-Ã©crÃ©mÃ©": {emoji: "ğŸ¥›", calories: 98, quantite: 200, unite: "ml", categorie: "Boissons"},
  "lait entier": {emoji: "ğŸ¥›", calories: 128, quantite: 200, unite: "ml", categorie: "Boissons"},
  "lait d'amande": {emoji: "ğŸ¥›", calories: 48, quantite: 200, unite: "ml", categorie: "Boissons"},
  "lait d'avoine": {emoji: "ğŸ¥›", calories: 94, quantite: 200, unite: "ml", categorie: "Boissons"},
  "lait de coco": {emoji: "ğŸ¥¥", calories: 230, quantite: 100, unite: "ml", categorie: "Boissons"},
  "lait de soja": {emoji: "ğŸ¥›", calories: 108, quantite: 200, unite: "ml", categorie: "Boissons"},
  "langouste": {emoji: "ğŸ¦", calories: 135, quantite: 150, unite: "g", categorie: "Poissons"},
  "langoustine": {emoji: "ğŸ¦", calories: 84, quantite: 100, unite: "g", categorie: "Poissons"},
  "lapin": {emoji: "ğŸ‡", calories: 173, quantite: 100, unite: "g", categorie: "Viandes"},
  "lard": {emoji: "ğŸ¥“", calories: 201, quantite: 30, unite: "g", categorie: "Viandes"},
  "laurier": {emoji: "ğŸŒ¿", calories: 12, quantite: 2, unite: "g", categorie: "Aromates / Ã‰pices"},
  "lentilles corail": {emoji: "ğŸ«˜", calories: 93, quantite: 80, unite: "g", categorie: "LÃ©gumineuses"},
  "lentilles vertes": {emoji: "ğŸ«˜", calories: 93, quantite: 80, unite: "g", categorie: "LÃ©gumineuses"},
  "liÃ¨vre": {emoji: "ğŸ‡", calories: 114, quantite: 100, unite: "g", categorie: "Viandes"},
  "lieu": {emoji: "ğŸŸ", calories: 110, quantite: 120, unite: "g", categorie: "Poissons"},
  "limonade": {emoji: "ğŸ¥¤", calories: 103, quantite: 250, unite: "ml", categorie: "Boissons"},
  "litchi": {emoji: "ğŸˆ", calories: 66, quantite: 100, unite: "g", categorie: "Fruits"},
  "maÃ¯s": {emoji: "ğŸŒ½", calories: 86, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "mandarine": {emoji: "ğŸŠ", calories: 42, quantite: 80, unite: "g", categorie: "Fruits"},
  "mangue": {emoji: "ğŸ¥­", calories: 90, quantite: 150, unite: "g", categorie: "Fruits"},
  "manioc": {emoji: "ğŸ ", calories: 160, quantite: 100, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "maquereau": {emoji: "ğŸŸ", calories: 205, quantite: 100, unite: "g", categorie: "Poissons"},
  "margarine": {emoji: "ğŸ§ˆ", calories: 72, quantite: 10, unite: "g", categorie: "MatiÃ¨res grasses"},
  "marron": {emoji: "ğŸŒ°", calories: 98, quantite: 50, unite: "g", categorie: "Fruits Ã  coque"},
  "mascarpone": {emoji: "ğŸ§€", calories: 215, quantite: 50, unite: "g", categorie: "Produits laitiers"},
  "mayonnaise": {emoji: "ğŸ¥«", calories: 105, quantite: 15, unite: "g", categorie: "Condiments"},
  "melon": {emoji: "ğŸˆ", calories: 68, quantite: 200, unite: "g", categorie: "Fruits"},
  "menthe": {emoji: "ğŸŒ¿", calories: 4, quantite: 5, unite: "g", categorie: "Aromates / Ã‰pices"},
  "merguez": {emoji: "ğŸŒ­", calories: 300, quantite: 100, unite: "g", categorie: "Viandes"},
  "merlan": {emoji: "ğŸŸ", calories: 91, quantite: 120, unite: "g", categorie: "Poissons"},
  "miel": {emoji: "ğŸ¯", calories: 30, quantite: 10, unite: "g", categorie: "Produits sucrÃ©s"},
  "millet": {emoji: "ğŸŒ¾", calories: 227, quantite: 60, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "morue": {emoji: "ğŸŸ", calories: 98, quantite: 120, unite: "g", categorie: "Poissons"},
  "moules": {emoji: "ğŸš", calories: 129, quantite: 150, unite: "g", categorie: "Poissons"},
  "moutarde": {emoji: "ğŸ¯", calories: 7, quantite: 10, unite: "g", categorie: "Condiments"},
  "mozzarella": {emoji: "ğŸ§€", calories: 140, quantite: 50, unite: "g", categorie: "Produits laitiers"},
  "muesli": {emoji: "ğŸ¥£", calories: 185, quantite: 50, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "mÃ»re": {emoji: "ğŸ«", calories: 43, quantite: 100, unite: "g", categorie: "Fruits"},
  "muscade": {emoji: "ğŸŒ°", calories: 11, quantite: 2, unite: "g", categorie: "Aromates / Ã‰pices"},
  "myrtille": {emoji: "ğŸ«", calories: 57, quantite: 100, unite: "g", categorie: "Fruits"},
  "nectarine": {emoji: "ğŸ‘", calories: 44, quantite: 100, unite: "g", categorie: "Fruits"},
  "noisettes": {emoji: "ğŸŒ°", calories: 188, quantite: 30, unite: "g", categorie: "Fruits Ã  coque"},
  "noix": {emoji: "ğŸŒ°", calories: 196, quantite: 30, unite: "g", categorie: "Fruits Ã  coque"},
  "noix de cajou": {emoji: "ğŸ¥œ", calories: 166, quantite: 30, unite: "g", categorie: "Fruits Ã  coque"},
  "noix de pÃ©can": {emoji: "ğŸŒ°", calories: 207, quantite: 30, unite: "g", categorie: "Fruits Ã  coque"},
  "nutella": {emoji: "ğŸ«", calories: 108, quantite: 20, unite: "g", categorie: "Produits sucrÃ©s"},
  "Å“uf": {emoji: "ğŸ¥š", calories: 145, quantite: 60, unite: "g", categorie: "Å’ufs"},
  "oignon": {emoji: "ğŸ§…", calories: 32, quantite: 80, unite: "g", categorie: "LÃ©gumes"},
  "olive noire": {emoji: "ğŸ«’", calories: 23, quantite: 20, unite: "g", categorie: "LÃ©gumes"},
  "olive verte": {emoji: "ğŸ«’", calories: 29, quantite: 20, unite: "g", categorie: "LÃ©gumes"},
  "orange": {emoji: "ğŸŠ", calories: 71, quantite: 150, unite: "g", categorie: "Fruits"},
  "orge": {emoji: "ğŸŒ¾", calories: 211, quantite: 60, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "origan": {emoji: "ğŸŒ¿", calories: 5, quantite: 2, unite: "g", categorie: "Aromates / Ã‰pices"},
  "pain blanc": {emoji: "ğŸ", calories: 133, quantite: 50, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "pain complet": {emoji: "ğŸ", calories: 124, quantite: 50, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "pain de mie": {emoji: "ğŸ", calories: 81, quantite: 30, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "pain de seigle": {emoji: "ğŸ", calories: 130, quantite: 50, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "pamplemousse": {emoji: "ğŸŠ", calories: 63, quantite: 150, unite: "g", categorie: "Fruits"},
  "panais": {emoji: "ğŸ¥•", calories: 75, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "papaye": {emoji: "ğŸˆ", calories: 65, quantite: 150, unite: "g", categorie: "Fruits"},
  "paprika": {emoji: "ğŸŒ¶ï¸", calories: 14, quantite: 5, unite: "g", categorie: "Aromates / Ã‰pices"},
  "parmesan": {emoji: "ğŸ§€", calories: 43, quantite: 10, unite: "g", categorie: "Produits laitiers"},
  "pastÃ¨que": {emoji: "ğŸ‰", calories: 60, quantite: 200, unite: "g", categorie: "Fruits"},
  "patate douce": {emoji: "ğŸ ", calories: 129, quantite: 150, unite: "g", categorie: "LÃ©gumes"},
  "pÃ¢te Ã  tartiner": {emoji: "ğŸ«", calories: 108, quantite: 20, unite: "g", categorie: "Produits sucrÃ©s"},
  "pÃ¢tes": {emoji: "ğŸ", calories: 297, quantite: 80, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "pÃ¢tes complÃ¨tes": {emoji: "ğŸ", calories: 278, quantite: 80, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "pÃ¢tisserie": {emoji: "ğŸ°", calories: 400, quantite: 100, unite: "g", categorie: "Produits sucrÃ©s"},
  "pÃªche": {emoji: "ğŸ‘", calories: 59, quantite: 150, unite: "g", categorie: "Fruits"},
  "perche": {emoji: "ğŸŸ", calories: 109, quantite: 120, unite: "g", categorie: "Poissons"},
  "persil": {emoji: "ğŸŒ¿", calories: 4, quantite: 10, unite: "g", categorie: "Aromates / Ã‰pices"},
  "petit pois": {emoji: "ğŸ«›", calories: 81, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "petits suisses": {emoji: "ğŸ¥›", calories: 69, quantite: 60, unite: "g", categorie: "Produits laitiers"},
  "pickles": {emoji: "ğŸ¥’", calories: 2, quantite: 20, unite: "g", categorie: "Condiments"},
  "pignons de pin": {emoji: "ğŸŒ°", calories: 135, quantite: 20, unite: "g", categorie: "Fruits Ã  coque"},
  "pintade": {emoji: "ğŸ¦", calories: 110, quantite: 100, unite: "g", categorie: "Viandes"},
  "pistache": {emoji: "ğŸ¥œ", calories: 169, quantite: 30, unite: "g", categorie: "Fruits Ã  coque"},
  "pizza": {emoji: "ğŸ•", calories: 532, quantite: 200, unite: "g", categorie: "Plats prÃ©parÃ©s"},
  "plie": {emoji: "ğŸŸ", calories: 109, quantite: 120, unite: "g", categorie: "Poissons"},
  "poire": {emoji: "ğŸ", calories: 86, quantite: 150, unite: "g", categorie: "Fruits"},
  "poireau": {emoji: "ğŸ¥¬", calories: 92, quantite: 150, unite: "g", categorie: "LÃ©gumes"},
  "pois cassÃ©s": {emoji: "ğŸ«›", calories: 282, quantite: 80, unite: "g", categorie: "LÃ©gumineuses"},
  "pois chiches": {emoji: "ğŸ«›", calories: 291, quantite: 80, unite: "g", categorie: "LÃ©gumineuses"},
  "poisson panÃ©": {emoji: "ğŸŸ", calories: 200, quantite: 100, unite: "g", categorie: "Plats prÃ©parÃ©s"},
  "poivre": {emoji: "ğŸ§‚", calories: 0, quantite: 1, unite: "g", categorie: "Aromates / Ã‰pices"},
  "poivron": {emoji: "ğŸ«‘", calories: 20, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "polenta": {emoji: "ğŸŒ¾", calories: 286, quantite: 80, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "pomme": {emoji: "ğŸ", calories: 78, quantite: 150, unite: "g", categorie: "Fruits"},
  "pomme de terre": {emoji: "ğŸ¥”", calories: 116, quantite: 150, unite: "g", categorie: "LÃ©gumes"},
  "porc": {emoji: "ğŸ·", calories: 242, quantite: 100, unite: "g", categorie: "Viandes"},
  "pop-corn": {emoji: "ğŸ¿", calories: 116, quantite: 30, unite: "g", categorie: "Snacks"},
  "potimarron": {emoji: "ğŸƒ", calories: 48, quantite: 150, unite: "g", categorie: "LÃ©gumes"},
  "potiron": {emoji: "ğŸƒ", calories: 30, quantite: 150, unite: "g", categorie: "LÃ©gumes"},
  "poulet": {emoji: "ğŸ—", calories: 359, quantite: 150, unite: "g", categorie: "Viandes"},
  "poulpe": {emoji: "ğŸ™", calories: 82, quantite: 100, unite: "g", categorie: "Poissons"},
  "prune": {emoji: "ğŸ‘", calories: 28, quantite: 60, unite: "g", categorie: "Fruits"},
  "pruneau": {emoji: "ğŸ‘", calories: 72, quantite: 30, unite: "g", categorie: "Fruits"},
  "purÃ©e": {emoji: "ğŸ¥”", calories: 125, quantite: 150, unite: "g", categorie: "LÃ©gumes"},
  "quinoa": {emoji: "ğŸŒ¾", calories: 221, quantite: 60, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "radis": {emoji: "ğŸŒ¶ï¸", calories: 8, quantite: 50, unite: "g", categorie: "LÃ©gumes"},
  "radis noir": {emoji: "âš«", calories: 9, quantite: 50, unite: "g", categorie: "LÃ©gumes"},
  "raifort": {emoji: "ğŸ¥¬", calories: 5, quantite: 10, unite: "g", categorie: "Condiments"},
  "raisin blanc": {emoji: "ğŸ‡", calories: 69, quantite: 100, unite: "g", categorie: "Fruits"},
  "raisin noir": {emoji: "ğŸ‡", calories: 70, quantite: 100, unite: "g", categorie: "Fruits"},
  "raisin sec": {emoji: "ğŸ‡", calories: 90, quantite: 30, unite: "g", categorie: "Fruits"},
  "ravioli": {emoji: "ğŸ¥Ÿ", calories: 360, quantite: 200, unite: "g", categorie: "Plats prÃ©parÃ©s"},
  "rhubarbe": {emoji: "ğŸ¥¬", calories: 21, quantite: 100, unite: "g", categorie: "Fruits"},
  "ricotta": {emoji: "ğŸ§€", calories: 87, quantite: 50, unite: "g", categorie: "Produits laitiers"},
  "rillettes": {emoji: "ğŸ¥«", calories: 229, quantite: 50, unite: "g", categorie: "Viandes"},
  "riz basmati": {emoji: "ğŸš", calories: 207, quantite: 60, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "riz blanc": {emoji: "ğŸš", calories: 195, quantite: 150, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "riz complet": {emoji: "ğŸš", calories: 167, quantite: 150, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "roquefort": {emoji: "ğŸ§€", calories: 111, quantite: 30, unite: "g", categorie: "Produits laitiers"},
  "romarin": {emoji: "ğŸŒ¿", calories: 3, quantite: 1, unite: "g", categorie: "Aromates / Ã‰pices"},
  "rÃ´ti de bÅ“uf": {emoji: "ğŸ¥©", calories: 190, quantite: 100, unite: "g", categorie: "Viandes"},
  "rutabaga": {emoji: "ğŸ¥•", calories: 37, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "sablÃ©": {emoji: "ğŸª", calories: 99, quantite: 20, unite: "g", categorie: "Produits sucrÃ©s"},
  "salade": {emoji: "ğŸ¥—", calories: 15, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "salami": {emoji: "ğŸ–", calories: 122, quantite: 30, unite: "g", categorie: "Viandes"},
  "sandre": {emoji: "ğŸŸ", calories: 101, quantite: 120, unite: "g", categorie: "Poissons"},
  "sanglier": {emoji: "ğŸ—", calories: 122, quantite: 100, unite: "g", categorie: "Viandes"},
  "sardine": {emoji: "ğŸŸ", calories: 166, quantite: 80, unite: "g", categorie: "Poissons"},
  "sauce soja": {emoji: "ğŸ¥«", calories: 6, quantite: 10, unite: "ml", categorie: "Condiments"},
  "sauce tomate": {emoji: "ğŸ…", calories: 32, quantite: 100, unite: "g", categorie: "Condiments"},
  "saucisse": {emoji: "ğŸŒ­", calories: 301, quantite: 100, unite: "g", categorie: "Viandes"},
  "saucisson": {emoji: "ğŸ–", calories: 143, quantite: 30, unite: "g", categorie: "Viandes"},
  "saumon": {emoji: "ğŸŸ", calories: 250, quantite: 120, unite: "g", categorie: "Poissons"},
  "saumon fumÃ©": {emoji: "ğŸŸ", calories: 59, quantite: 50, unite: "g", categorie: "Poissons"},
  "sauge": {emoji: "ğŸŒ¿", calories: 6, quantite: 2, unite: "g", categorie: "Aromates / Ã‰pices"},
  "scarole": {emoji: "ğŸ¥¬", calories: 17, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "sel": {emoji: "ğŸ§‚", calories: 0, quantite: 5, unite: "g", categorie: "Condiments"},
  "semoule": {emoji: "ğŸŒ¾", calories: 216, quantite: 60, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "sÃ©same": {emoji: "ğŸŒ°", calories: 57, quantite: 10, unite: "g", categorie: "Aromates / Ã‰pices"},
  "sirop d'agave": {emoji: "ğŸ¯", calories: 31, quantite: 10, unite: "g", categorie: "Produits sucrÃ©s"},
  "sirop d'Ã©rable": {emoji: "ğŸ¯", calories: 39, quantite: 15, unite: "g", categorie: "Produits sucrÃ©s"},
  "smoothie": {emoji: "ğŸ§‹", calories: 150, quantite: 250, unite: "ml", categorie: "Boissons"},
  "sole": {emoji: "ğŸŸ", calories: 84, quantite: 120, unite: "g", categorie: "Poissons"},
  "son d'avoine": {emoji: "ğŸ¥£", calories: 49, quantite: 20, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "sorbet": {emoji: "ğŸ¨", calories: 132, quantite: 100, unite: "g", categorie: "Produits sucrÃ©s"},
  "sorgho": {emoji: "ğŸŒ¾", calories: 203, quantite: 60, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "soupe": {emoji: "ğŸ²", calories: 100, quantite: 250, unite: "ml", categorie: "Plats prÃ©parÃ©s"},
  "spaghetti": {emoji: "ğŸ", calories: 297, quantite: 80, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "steak hachÃ©": {emoji: "ğŸ¥©", calories: 250, quantite: 100, unite: "g", categorie: "Viandes"},
  "sucre blanc": {emoji: "ğŸš", calories: 20, quantite: 5, unite: "g", categorie: "Produits sucrÃ©s"},
  "sucre de canne": {emoji: "ğŸš", calories: 20, quantite: 5, unite: "g", categorie: "Produits sucrÃ©s"},
  "sucre roux": {emoji: "ğŸš", calories: 20, quantite: 5, unite: "g", categorie: "Produits sucrÃ©s"},
  "surimi": {emoji: "ğŸ¦€", calories: 50, quantite: 50, unite: "g", categorie: "Poissons"},
  "tabasco": {emoji: "ğŸŒ¶ï¸", calories: 0, quantite: 2, unite: "ml", categorie: "Condiments"},
  "tagliatelles": {emoji: "ğŸ", calories: 297, quantite: 80, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "tahini": {emoji: "ğŸ¥œ", calories: 119, quantite: 20, unite: "g", categorie: "MatiÃ¨res grasses"},
  "tapioca": {emoji: "ğŸš", calories: 215, quantite: 60, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "tapenade": {emoji: "ğŸ«’", calories: 43, quantite: 20, unite: "g", categorie: "Condiments"},
  "tarama": {emoji: "ğŸŸ", calories: 134, quantite: 30, unite: "g", categorie: "Poissons"},
  "tarte": {emoji: "ğŸ¥§", calories: 360, quantite: 120, unite: "g", categorie: "Produits sucrÃ©s"},
  "thÃ©": {emoji: "â˜•", calories: 2, quantite: 200, unite: "ml", categorie: "Boissons"},
  "thon": {emoji: "ğŸŸ", calories: 144, quantite: 100, unite: "g", categorie: "Poissons"},
  "thon en conserve": {emoji: "ğŸŸ", calories: 93, quantite: 80, unite: "g", categorie: "Poissons"},
  "thym": {emoji: "ğŸŒ¿", calories: 7, quantite: 5, unite: "g", categorie: "Aromates / Ã‰pices"},
  "tofu": {emoji: "ğŸ¥¡", calories: 76, quantite: 100, unite: "g", categorie: "ProtÃ©ines vÃ©gÃ©tales"},
  "tomate": {emoji: "ğŸ…", calories: 27, quantite: 150, unite: "g", categorie: "LÃ©gumes"},
  "tomate cerise": {emoji: "ğŸ…", calories: 18, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "tomate sÃ©chÃ©e": {emoji: "ğŸ…", calories: 52, quantite: 20, unite: "g", categorie: "LÃ©gumes"},
  "topinambour": {emoji: "ğŸ¥”", calories: 73, quantite: 100, unite: "g", categorie: "LÃ©gumes"},
  "tortilla": {emoji: "ğŸŒ®", calories: 156, quantite: 50, unite: "g", categorie: "FÃ©culents / CÃ©rÃ©ales"},
  "tournesol (graines)": {emoji: "ğŸŒ»", calories: 117, quantite: 20, unite: "g", categorie: "Fruits Ã  coque"},
  "truite": {emoji: "ğŸŸ", calories: 143, quantite: 120, unite: "g", categorie: "Poissons"},
  "turbot": {emoji: "ğŸŸ", calories: 114, quantite: 120, unite: "g", categorie: "Poissons"},
  "veau": {emoji: "ğŸ–", calories: 172, quantite: 100, unite: "g", categorie: "Viandes"},
  "vinaigre": {emoji: "ğŸ¾", calories: 2, quantite: 10, unite: "ml", categorie: "Condiments"},
  "vinaigre balsamique": {emoji: "ğŸ¾", calories: 9, quantite: 10, unite: "ml", categorie: "Condiments"},
  "wasabi": {emoji: "ğŸŸ¢", calories: 5, quantite: 5, unite: "g", categorie: "Condiments"},
  "whisky": {emoji: "ğŸ¥ƒ", calories: 75, quantite: 30, unite: "ml", categorie: "Boissons"},
  "yaourt grec": {emoji: "ğŸ¥›", calories: 121, quantite: 125, unite: "g", categorie: "Produits laitiers"},
  "yaourt nature": {emoji: "ğŸ¥›", calories: 76, quantite: 125, unite: "g", categorie: "Produits laitiers"},
  "yaourt aux fruits": {emoji: "ğŸ¥›", calories: 113, quantite: 125, unite: "g", categorie: "Produits laitiers"}
};
        // Base de recettes pratiques
        const RECETTES = [
            {
                id: "poulet-roti-legumes",
                titre: "Poulet rÃ´ti et lÃ©gumes",
                ingredients: ["poulet", "carotte", "pomme de terre", "oignon"],
                temps: "1h",
                difficulte: "Facile",
                portions: 4,
                tags: ["batch", "economique"],
                etapes: [
                    "PrÃ©chauffez le four Ã  200Â°C",
                    "Assaisonnez le poulet avec sel, poivre et herbes",
                    "Coupez les lÃ©gumes en gros morceaux",
                    "Disposez le tout dans un plat, arrosez d'huile d'olive",
                    "Enfournez 50-60 minutes en arrosant rÃ©guliÃ¨rement"
                ],
                conseil: "ğŸ’¡ PrÃ©parez-en plus : le poulet froid est parfait en salade le lendemain !"
            },
            {
                id: "pates-saumon-courgette",
                titre: "PÃ¢tes au saumon et courgettes",
                ingredients: ["pÃ¢tes", "saumon", "courgette", "citron"],
                temps: "20min",
                difficulte: "Facile",
                portions: 2,
                tags: ["rapide", "facile"],
                etapes: [
                    "Faites cuire les pÃ¢tes selon les instructions",
                    "Coupez les courgettes en rondelles et faites-les revenir",
                    "Ajoutez le saumon en morceaux",
                    "MÃ©langez avec les pÃ¢tes Ã©gouttÃ©es",
                    "Ajoutez un filet de citron et servez"
                ],
                conseil: "âš¡ Ultra rapide et Ã©quilibrÃ©, parfait pour les soirs pressÃ©s !"
            },
            {
                id: "omelette-legumes",
                titre: "Omelette aux lÃ©gumes",
                ingredients: ["Å“uf", "tomate", "poivron", "oignon"],
                temps: "15min",
                difficulte: "TrÃ¨s facile",
                portions: 1,
                tags: ["rapide", "facile", "economique"],
                etapes: [
                    "Coupez les lÃ©gumes en petits dÃ©s",
                    "Faites-les revenir 5 minutes dans une poÃªle",
                    "Battez 2-3 Å“ufs et versez sur les lÃ©gumes",
                    "Cuisez Ã  feu doux jusqu'Ã  ce que l'omelette soit prise",
                    "Pliez et servez chaud"
                ],
                conseil: "ğŸ‘ IdÃ©al pour utiliser les restes de lÃ©gumes du frigo !"
            },
            {
                id: "salade-composee",
                titre: "Salade complÃ¨te",
                ingredients: ["salade", "tomate", "thon", "Å“uf", "avocat"],
                temps: "10min",
                difficulte: "TrÃ¨s facile",
                portions: 2,
                tags: ["rapide", "facile"],
                etapes: [
                    "Lavez et essorez la salade",
                    "Coupez les tomates en quartiers",
                    "Ajoutez le thon Ã©gouttÃ©",
                    "Ajoutez les Å“ufs durs coupÃ©s et l'avocat en tranches",
                    "Assaisonnez avec vinaigrette"
                ],
                conseil: "âš¡ Repas complet prÃªt en 10 minutes, idÃ©al l'Ã©tÃ© !"
            },
            {
                id: "riz-poulet-curry",
                titre: "Riz au poulet et curry",
                ingredients: ["riz", "poulet", "carotte", "oignon"],
                temps: "30min",
                difficulte: "Facile",
                portions: 4,
                tags: ["batch", "economique"],
                etapes: [
                    "Faites cuire le riz selon les instructions",
                    "Coupez le poulet en morceaux et faites-le dorer",
                    "Ajoutez les lÃ©gumes coupÃ©s en dÃ©s",
                    "Saupoudrez de curry, ajoutez un peu d'eau",
                    "Laissez mijoter 15 minutes et servez avec le riz"
                ],
                conseil: "ğŸ’¡ Se conserve 3 jours au frigo, parfait pour les lunchs !"
            },
            {
                id: "gratin-courgettes",
                titre: "Gratin de courgettes",
                ingredients: ["courgette", "fromage blanc", "Å“uf"],
                temps: "40min",
                difficulte: "Facile",
                portions: 4,
                tags: ["batch", "economique"],
                etapes: [
                    "Coupez les courgettes en rondelles",
                    "Faites-les revenir lÃ©gÃ¨rement Ã  la poÃªle",
                    "MÃ©langez fromage blanc et Å“ufs battus",
                    "Disposez les courgettes dans un plat, versez la prÃ©paration",
                    "Enfournez 30 minutes Ã  180Â°C"
                ],
                conseil: "ğŸ½ï¸ DÃ©licieux chaud ou froid, se rÃ©chauffe facilement !"
            },
            {
                id: "soupe-legumes",
                titre: "Soupe de lÃ©gumes maison",
                ingredients: ["carotte", "poireau", "pomme de terre", "oignon"],
                temps: "45min",
                difficulte: "TrÃ¨s facile",
                portions: 6,
                tags: ["batch", "economique"],
                etapes: [
                    "Ã‰pluchez et coupez tous les lÃ©gumes",
                    "Faites revenir l'oignon dans un peu d'huile",
                    "Ajoutez les autres lÃ©gumes et couvrez d'eau",
                    "Laissez mijoter 30 minutes",
                    "Mixez si vous le souhaitez"
                ],
                conseil: "â±ï¸ PrÃ©parez-en une grande quantitÃ©, se congÃ¨le parfaitement !"
            },
            {
                id: "poisson-papillote",
                titre: "Poisson en papillote",
                ingredients: ["cabillaud", "tomate", "citron", "courgette"],
                temps: "25min",
                difficulte: "Facile",
                portions: 2,
                tags: ["rapide", "facile"],
                etapes: [
                    "Coupez des lÃ©gumes en fines rondelles",
                    "Disposez le poisson sur du papier sulfurisÃ©",
                    "Ajoutez les lÃ©gumes, citron, sel, poivre",
                    "Fermez la papillote",
                    "Enfournez 20 minutes Ã  180Â°C"
                ],
                conseil: "ğŸ‘ Cuisson saine et sans matiÃ¨re grasse, zÃ©ro vaisselle !"
            },
            {
                id: "quiche-legumes",
                titre: "Quiche aux lÃ©gumes",
                ingredients: ["Å“uf", "fromage blanc", "courgette", "tomate"],
                temps: "45min",
                difficulte: "Facile",
                portions: 6,
                tags: ["batch", "economique"],
                etapes: [
                    "Ã‰talez une pÃ¢te brisÃ©e dans un moule",
                    "Faites revenir les lÃ©gumes coupÃ©s",
                    "Battez les Å“ufs avec le fromage blanc",
                    "Disposez les lÃ©gumes, versez la prÃ©paration",
                    "Enfournez 35 minutes Ã  180Â°C"
                ],
                conseil: "ğŸ’¡ Se mange chaude ou froide, parfaite pour les pique-niques !"
            },
            {
                id: "lentilles-legumes",
                titre: "Lentilles aux lÃ©gumes",
                ingredients: ["lentilles", "carotte", "oignon", "tomate"],
                temps: "35min",
                difficulte: "TrÃ¨s facile",
                portions: 4,
                tags: ["batch", "economique"],
                etapes: [
                    "Rincez les lentilles",
                    "Faites revenir l'oignon et les carottes coupÃ©es",
                    "Ajoutez les lentilles et couvrez d'eau",
                    "Ajoutez les tomates coupÃ©es",
                    "Laissez mijoter 25 minutes"
                ],
                conseil: "â±ï¸ Riche en protÃ©ines vÃ©gÃ©tales, se rÃ©chauffe parfaitement !"
            },
            {
                id: "salade-riz-thon",
                titre: "Salade de riz au thon",
                ingredients: ["riz", "thon", "tomate", "concombre"],
                temps: "20min",
                difficulte: "TrÃ¨s facile",
                portions: 3,
                tags: ["rapide", "facile", "batch"],
                etapes: [
                    "Faites cuire le riz et laissez refroidir",
                    "Coupez les lÃ©gumes en petits dÃ©s",
                    "MÃ©langez avec le thon Ã©gouttÃ©",
                    "Assaisonnez avec vinaigrette",
                    "RÃ©servez au frais"
                ],
                conseil: "ğŸ± Parfait Ã  prÃ©parer la veille pour les lunchs !"
            },
            {
                id: "brocoli-vapeur-poulet",
                titre: "Brocoli vapeur et poulet grillÃ©",
                ingredients: ["brocoli", "poulet", "ail", "citron"],
                temps: "20min",
                difficulte: "TrÃ¨s facile",
                portions: 2,
                tags: ["rapide", "facile"],
                etapes: [
                    "Faites cuire le brocoli Ã  la vapeur 10 minutes",
                    "Grillez le poulet assaisonnÃ© Ã  la poÃªle",
                    "PrÃ©parez une sauce ail-citron",
                    "Servez le tout ensemble",
                    "Arrosez de la sauce"
                ],
                conseil: "âš¡ Repas sain et rapide, riche en protÃ©ines !"
            }
        ];

        const JOURS = ["Lundi", "Mardi", "Mercredi", "Jeudi", "Vendredi", "Samedi", "Dimanche"];
        const REPAS = ["Petit dÃ©jeuner", "DÃ©jeuner", "DÃ®ner"];

        let menus = {};
        let stock = {};
        let envies = [];
        let selectedCategory = "Tous";
        let recettesSemaine = {};
        let recettesJour = {};

        function initialiser() {
            JOURS.forEach(jour => {
                menus[jour] = {};
                REPAS.forEach(repas => {
                    menus[jour][repas] = [];
                });
            });

            chargerDepuisLocalStorage();
            afficherCategories();
            afficherAliments();
            afficherCalendrier();
            remplirSelectsAliments();
        }

        function remplirSelectsAliments() {
            const selectStock = document.getElementById('alimentStockSelect');
            const selectEnvie = document.getElementById('alimentEnvieSelect');
            
            const options = Object.keys(ALIMENTS).sort().map(nom => 
                `<option value="${nom}">${ALIMENTS[nom].emoji} ${nom.charAt(0).toUpperCase() + nom.slice(1)}</option>`
            ).join('');
            
            selectStock.innerHTML = '<option value="">Choisir un aliment...</option>' + options;
            selectEnvie.innerHTML = '<option value="">Choisir un aliment...</option>' + options;
        }

        function remplirSelectJoursRepas() {
            const selectJour = document.getElementById('jourRecetteSelect');
            const selectRepas = document.getElementById('repasRecetteSelect');
            
            selectJour.innerHTML = '<option value="">Choisir un jour...</option>' + 
                JOURS.map(j => `<option value="${j}">${j}</option>`).join('');
            
            selectRepas.innerHTML = '<option value="">Choisir un repas...</option>' + 
                REPAS.map(r => `<option value="${r}">${r}</option>`).join('');
        }

        function ajouterAuStock() {
            const select = document.getElementById('alimentStockSelect');
            const quantiteInput = document.getElementById('quantiteStock');
            const aliment = select.value;
            const quantite = parseInt(quantiteInput.value);

            if (!aliment || !quantite) {
                alert('Veuillez choisir un aliment et une quantitÃ©');
                return;
            }

            stock[aliment] = (stock[aliment] || 0) + quantite;
            afficherStock();
            afficherAliments();
            sauvegarderDansLocalStorage();
            quantiteInput.value = '1';
        }

        function ajouterAuxEnvies() {
            const select = document.getElementById('alimentEnvieSelect');
            const aliment = select.value;

            if (!aliment) {
                alert('Veuillez choisir un aliment');
                return;
            }

            if (!envies.includes(aliment)) {
                envies.push(aliment);
                afficherEnvies();
                afficherAliments();
                sauvegarderDansLocalStorage();
            }
        }

        function retirerDuStock(aliment) {
            delete stock[aliment];
            afficherStock();
            afficherAliments();
            sauvegarderDansLocalStorage();
        }

        function retirerDesEnvies(aliment) {
            envies = envies.filter(a => a !== aliment);
            afficherEnvies();
            afficherAliments();
            sauvegarderDansLocalStorage();
        }

        function afficherStock() {
            const container = document.getElementById('stockList');
            if (Object.keys(stock).length === 0) {
                container.innerHTML = '<div class="empty-state">Aucun aliment en stock</div>';
                return;
            }

            container.innerHTML = Object.entries(stock).map(([nom, quantite]) => {
                const aliment = ALIMENTS[nom];
                return `
                    <div class="stock-item">
                        <div class="stock-item-info">
                            <span style="font-size: 1.5em;">${aliment.emoji}</span>
                            <div>
                                <div style="font-weight: 600;">${nom.charAt(0).toUpperCase() + nom.slice(1)}</div>
                                <div style="font-size: 0.85em; color: #6b7280;">${quantite} Ã— ${aliment.quantite}${aliment.unite}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="retirerDuStock('${nom}')">âœ•</button>
                    </div>
                `;
            }).join('');
        }

        function afficherEnvies() {
            const container = document.getElementById('enviesList');
            if (envies.length === 0) {
                container.innerHTML = '<div class="empty-state">Aucune envie ajoutÃ©e</div>';
                return;
            }

            container.innerHTML = envies.map(nom => {
                const aliment = ALIMENTS[nom];
                return `
                    <div class="stock-item">
                        <div class="stock-item-info">
                            <span style="font-size: 1.5em;">${aliment.emoji}</span>
                            <div style="font-weight: 600;">${nom.charAt(0).toUpperCase() + nom.slice(1)}</div>
                        </div>
                        <button class="remove-btn" onclick="retirerDesEnvies('${nom}')">âœ•</button>
                    </div>
                `;
            }).join('');
        }

        function afficherCategories() {
            const categories = ["Tous", ...new Set(Object.values(ALIMENTS).map(a => a.categorie))];
            const container = document.getElementById('categoryFilter');
            container.innerHTML = categories.map(cat => 
                `<button class="category-btn ${cat === selectedCategory ? 'active' : ''}" onclick="filtrerParCategorie('${cat}')">${cat}</button>`
            ).join('');
        }

        function filtrerParCategorie(categorie) {
            selectedCategory = categorie;
            afficherCategories();
            afficherAliments();
        }

        function filtrerAliments() {
            afficherAliments();
        }

        function afficherAliments() {
            const searchTerm = document.getElementById('searchBox').value.toLowerCase();
            const container = document.getElementById('alimentsList');
            
            const alimentsFiltres = Object.entries(ALIMENTS).filter(([nom, data]) => {
                const matchSearch = nom.toLowerCase().includes(searchTerm);
                const matchCategory = selectedCategory === "Tous" || data.categorie === selectedCategory;
                return matchSearch && matchCategory;
            });

            container.innerHTML = alimentsFiltres.map(([nom, data]) => {
                const inStock = stock[nom] > 0;
                const inWishlist = envies.includes(nom);
                const classes = ['aliment-item'];
                if (inStock) classes.push('in-stock');
                if (inWishlist) classes.push('in-wishlist');

                return `
                    <div class="${classes.join(' ')}" draggable="true" ondragstart="drag(event)" data-aliment="${nom}">
                        <div class="aliment-info">
                            <div class="aliment-name">${data.emoji} ${nom.charAt(0).toUpperCase() + nom.slice(1)}</div>
                            <div class="aliment-calories">${data.calories} kcal â€¢ ${data.quantite}${data.unite}</div>
                        </div>
                        ${inStock ? '<span class="stock-badge">Stock</span>' : ''}
                        ${inWishlist ? '<span class="wishlist-badge">Envie</span>' : ''}
                    </div>
                `;
            }).join('');
        }

        function afficherCalendrier() {
            const container = document.getElementById('calendarGrid');
            container.innerHTML = JOURS.map(jour => {
                const totalJour = calculerTotalJour(jour);
                return `
                    <div class="day-card">
                        <div class="day-header">
                            <span>${jour}</span>
                            <span class="day-total">${totalJour} kcal</span>
                        </div>
                        ${REPAS.map(repas => {
                            const totalRepas = calculerTotalRepas(jour, repas);
                            return `
                                <div class="meal-section">
								<button class="recipe-hint-btn" onclick="genRecetteIA('` + jour + `','` + repas + `')">
                                â­ Recette IA
                                    </button>
                                    <div class="meal-title">
									<button class="recipe-hint-btn" onclick="genRecetteIA('` + jour + `','` + repas + `')">
                                â­ Recette IA
                                    </button>
                                        <span>${repas === "Petit dÃ©jeuner" ? "ğŸŒ…" : repas === "DÃ©jeuner" ? "â˜€ï¸" : "ğŸŒ™"} ${repas}</span>
                                        <span class="meal-calories">${totalRepas} kcal</span>
										<button class="recipe-hint-btn" onclick="genRecetteIA('` + jour + `','` + repas + `')">
                                â­ Recette IA
                                    </button>
                                    </div>
                                    <div class="drop-zone" 
                                         ondrop="drop(event)" 
                                         ondragover="allowDrop(event)"
                                         ondragleave="dragLeave(event)"
                                         data-jour="${jour}" 
                                         data-repas="${repas}">
                                        ${afficherRepas(jour, repas)}
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
            }).join('');
        }

        function afficherRepas(jour, repas) {
            const items = menus[jour][repas];
            if (items.length === 0) {
                return '<div class="empty-state">Glissez des aliments ici</div>';
            }
            return items.map((item, index) => {
                const aliment = ALIMENTS[item.nom];
                const calories = Math.round(item.quantite / aliment.quantite * aliment.calories);
                return `
                    <div class="meal-item">
                        <div class="meal-item-info">
                            <div class="meal-item-name">${aliment.emoji} ${item.nom.charAt(0).toUpperCase() + item.nom.slice(1)}</div>
                            <div class="meal-item-details">${item.quantite}${aliment.unite} â€¢ ${calories} kcal</div>
                        </div>
                        <button class="remove-btn" onclick="retirerAliment('${jour}', '${repas}', ${index})">âœ•</button>
                    </div>
                `;
            }).join('');
        }

        function drag(ev) {
            ev.dataTransfer.setData("aliment", ev.target.dataset.aliment);
            ev.target.classList.add('dragging');
        }

        function allowDrop(ev) {
            ev.preventDefault();
            ev.target.closest('.drop-zone').classList.add('drag-over');
        }

        function dragLeave(ev) {
            ev.target.closest('.drop-zone').classList.remove('drag-over');
        }

        function drop(ev) {
            ev.preventDefault();
            const dropZone = ev.target.closest('.drop-zone');
            dropZone.classList.remove('drag-over');
            
            const alimentNom = ev.dataTransfer.getData("aliment");
            const jour = dropZone.dataset.jour;
            const repas = dropZone.dataset.repas;
            
            const quantite = prompt(`QuantitÃ© pour ${alimentNom} (en ${ALIMENTS[alimentNom].unite}) :`, ALIMENTS[alimentNom].quantite);
            
            if (quantite && !isNaN(quantite)) {
                menus[jour][repas].push({
                    nom: alimentNom,
                    quantite: parseInt(quantite)
                });
                afficherCalendrier();
                sauvegarderDansLocalStorage();
            }

            document.querySelectorAll('.aliment-item').forEach(item => {
                item.classList.remove('dragging');
            });
        }

        function retirerAliment(jour, repas, index) {
            menus[jour][repas].splice(index, 1);
            afficherCalendrier();
            sauvegarderDansLocalStorage();
        }

        function calculerTotalRepas(jour, repas) {
            return menus[jour][repas].reduce((total, item) => {
                const aliment = ALIMENTS[item.nom];
                return total + Math.round(item.quantite / aliment.quantite * aliment.calories);
            }, 0);
        }

        function calculerTotalJour(jour) {
            return REPAS.reduce((total, repas) => total + calculerTotalRepas(jour, repas), 0);
        }

        function calculerTotalSemaine() {
            return JOURS.reduce((total, jour) => total + calculerTotalJour(jour), 0);
        }

        function genererMenuEquilibre() {
            if (!confirm('Cela va remplacer tous vos menus actuels. Continuer ?')) return;

            const alimentsDispos = Object.keys(ALIMENTS);
            
            // PrioritÃ© au stock et aux envies
            const alimentsPrioritaires = [
                ...Object.keys(stock),
                ...envies.filter(e => !stock[e])
            ];

            const proteines = alimentsDispos.filter(nom => 
                ['Viandes', 'Poissons', 'Å’ufs'].includes(ALIMENTS[nom].categorie)
            );
            const feculents = alimentsDispos.filter(nom => 
                ALIMENTS[nom].categorie === 'FÃ©culents'
            );
            const legumes = alimentsDispos.filter(nom => 
                ALIMENTS[nom].categorie === 'LÃ©gumes'
            );
            const fruits = alimentsDispos.filter(nom => 
                ALIMENTS[nom].categorie === 'Fruits'
            );

            function choisirAliment(liste) {
                const prioritaires = liste.filter(a => alimentsPrioritaires.includes(a));
                if (prioritaires.length > 0) {
                    return prioritaires[Math.floor(Math.random() * prioritaires.length)];
                }
                return liste[Math.floor(Math.random() * liste.length)];
            }

            JOURS.forEach(jour => {
                menus[jour]["Petit dÃ©jeuner"] = [
                    {nom: "cafÃ©", quantite: 200},
                    {nom: "pain complet", quantite: 50},
                    {nom: "beurre", quantite: 10}
                ];

                const proteineDej = choisirAliment(proteines);
                const feculentDej = choisirAliment(feculents);
                const legumeDej = choisirAliment(legumes);

                menus[jour]["DÃ©jeuner"] = [
                    {nom: proteineDej, quantite: ALIMENTS[proteineDej].quantite},
                    {nom: feculentDej, quantite: ALIMENTS[feculentDej].quantite},
                    {nom: legumeDej, quantite: ALIMENTS[legumeDej].quantite}
                ];

                const proteineDin = choisirAliment(proteines);
                const legumeDin = choisirAliment(legumes);
                const fruitDin = choisirAliment(fruits);

                menus[jour]["DÃ®ner"] = [
                    {nom: proteineDin, quantite: ALIMENTS[proteineDin].quantite},
                    {nom: legumeDin, quantite: ALIMENTS[legumeDin].quantite},
                    {nom: fruitDin, quantite: ALIMENTS[fruitDin].quantite}
                ];
            });

            afficherCalendrier();
            sauvegarderDansLocalStorage();
            alert('âœ… Menu Ã©quilibrÃ© gÃ©nÃ©rÃ© en utilisant votre stock et vos envies !');
        }

        function suggererRecette(jour, repas) {
            const ingredients = menus[jour][repas].map(item => item.nom);
            const recettesTrouvees = RECETTES.filter(recette => {
                return recette.ingredients.some(ing => ingredients.includes(ing));
            });

            if (recettesTrouvees.length > 0) {
                const recette = recettesTrouvees[0];
                afficherDetailRecette(recette);
            } else {
                alert('Aucune recette correspondante trouvÃ©e. Consultez toutes nos recettes dans "ğŸ‘¨â€ğŸ³ IdÃ©es Recettes" !');
            }
        }
        function afficherListeCourses() {
            const courses = {};

            JOURS.forEach(jour => {
                REPAS.forEach(repas => {
                    menus[jour][repas].forEach(item => {
                        if (courses[item.nom]) {
                            courses[item.nom] += item.quantite;
                        } else {
                            courses[item.nom] = item.quantite;
                        }
                    });
                });
            });

            // Soustraire ce qu'on a en stock
            Object.keys(stock).forEach(aliment => {
                if (courses[aliment]) {
                    const alimentData = ALIMENTS[aliment];
                    const quantiteEnStock = stock[aliment] * alimentData.quantite;
                    courses[aliment] = Math.max(0, courses[aliment] - quantiteEnStock);
                    if (courses[aliment] === 0) {
                        delete courses[aliment];
                    }
                }
            });

            const container = document.getElementById('shoppingList');
            const items = Object.entries(courses).sort((a, b) => a[0].localeCompare(b[0]));

            if (items.length === 0) {
                container.innerHTML = '<div class="empty-state">Tout est en stock ! ğŸ‰</div>';
            } else {
                container.innerHTML = items.map(([nom, quantite]) => {
                    const aliment = ALIMENTS[nom];
                    return `
                        <li class="shopping-item">
                            <span>${aliment.emoji} ${nom.charAt(0).toUpperCase() + nom.slice(1)}</span>
                            <strong>${quantite} ${aliment.unite}</strong>
                        </li>
                    `;
                }).join('');
            }

            document.getElementById('shoppingModal').classList.add('active');
        }

        function afficherStatistiques() {
            const totalSemaine = calculerTotalSemaine();
            const moyenneJour = Math.round(totalSemaine / 7);
            
            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${totalSemaine}</div>
                    <div class="stat-label">Calories totales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${moyenneJour}</div>
                    <div class="stat-label">Moyenne par jour</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${Object.keys(stock).length}</div>
                    <div class="stat-label">Aliments en stock</div>
                </div>
            `;

            const detailsStats = document.getElementById('detailsStats');
            detailsStats.innerHTML = `
                <h3 style="margin-top: 20px; margin-bottom: 15px;">ğŸ“… DÃ©tail par jour</h3>
                ${JOURS.map(jour => {
                    const total = calculerTotalJour(jour);
                    const pourcent = totalSemaine > 0 ? Math.round((total / totalSemaine) * 100) : 0;
                    return `
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <strong>${jour}</strong>
                                <span>${total} kcal (${pourcent}%)</span>
                            </div>
                            <div style="background: #e5e7eb; height: 10px; border-radius: 5px; overflow: hidden;">
                                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); height: 100%; width: ${pourcent}%; transition: width 0.3s;"></div>
                            </div>
                        </div>
                    `;
                }).join('')}
            `;

            document.getElementById('statsModal').classList.add('active');
        }

        function reinitialiserMenus() {
            if (confirm('âš ï¸ ÃŠtes-vous sÃ»r de vouloir effacer tous les menus ?')) {
                JOURS.forEach(jour => {
                    REPAS.forEach(repas => {
                        menus[jour][repas] = [];
                    });
                });
                afficherCalendrier();
                sauvegarderDansLocalStorage();
                alert('âœ… Tous les menus ont Ã©tÃ© rÃ©initialisÃ©s');
            }
        }

        function ouvrirStock() {
            afficherStock();
            document.getElementById('stockModal').classList.add('active');
        }

        function ouvrirEnvies() {
            afficherEnvies();
            document.getElementById('enviesModal').classList.add('active');
        }

        function ouvrirRecettes() {
            document.getElementById('recettesModal').classList.add('active');
        }

        function changerOngletRecette(onglet) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            if (onglet === 'semaine') {
                document.getElementById('recetteSemaine').classList.add('active');
            } else {
                document.getElementById('recetteJour').classList.add('active');
            }
        }

        async function genererRecettesSemaine() {
            const container = document.getElementById('recettesSemaineContent');
            container.innerHTML = '<div class="loading"><div class="spinner"></div><p>GÃ©nÃ©ration des recettes en cours...</p></div>';

            try {
                for (const jour of JOURS) {
                    for (const repas of REPAS) {
                        if (menus[jour][repas].length > 0) {
                            const recette = await genererRecette(jour, repas, menus[jour][repas]);
                            if (!recettesSemaine[jour]) recettesSemaine[jour] = {};
                            recettesSemaine[jour][repas] = recette;
                        }
                    }
                }

                afficherRecettesSemaine();
                sauvegarderDansLocalStorage();
            } catch (error) {
                container.innerHTML = '<div class="empty-state">âŒ Erreur lors de la gÃ©nÃ©ration des recettes</div>';
            }
        }

        function afficherRecettesSemaine() {
            const container = document.getElementById('recettesSemaineContent');
            let html = '';

            JOURS.forEach(jour => {
                if (recettesSemaine[jour]) {
                    html += `<h3 style="margin: 20px 0 15px 0; color: var(--primary);">${jour}</h3>`;
                    REPAS.forEach(repas => {
                        if (recettesSemaine[jour][repas]) {
                            html += formaterRecette(recettesSemaine[jour][repas], `${jour} - ${repas}`);
                        }
                    });
                }
            });

            container.innerHTML = html || '<div class="empty-state">Aucune recette gÃ©nÃ©rÃ©e</div>';
        }

        async function genererRecetteJour() {
            const jour = document.getElementById('jourRecetteSelect').value;
            const repas = document.getElementById('repasRecetteSelect').value;

            if (!jour || !repas) {
                alert('Veuillez choisir un jour et un repas');
                return;
            }

            if (menus[jour][repas].length === 0) {
                alert('Ce repas ne contient aucun aliment');
                return;
            }

            const container = document.getElementById('recettesJourContent');
            container.innerHTML = '<div class="loading"><div class="spinner"></div><p>GÃ©nÃ©ration de la recette...</p></div>';

            try {
                const recette = await genererRecette(jour, repas, menus[jour][repas]);
                if (!recettesJour[jour]) recettesJour[jour] = {};
                recettesJour[jour][repas] = recette;
                
                container.innerHTML = formaterRecette(recette, `${jour} - ${repas}`);
                sauvegarderDansLocalStorage();
            } catch (error) {
                container.innerHTML = '<div class="empty-state">âŒ Erreur lors de la gÃ©nÃ©ration de la recette</div>';
            }
        }

        async function genererRecette(jour, repas, ingredients) {
            const ingredientsTexte = ingredients.map(item => {
                const aliment = ALIMENTS[item.nom];
                return `${item.quantite}${aliment.unite} de ${item.nom}`;
            }).join(', ');

            const response = await fetch("https://api.anthropic.com/v1/messages", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    model: "claude-sonnet-4-20250514",
                    max_tokens: 1000,
                    messages: [{
                        role: "user",
                        content: `Tu es un chef cuisinier crÃ©atif. CrÃ©e une recette simple et savoureuse avec ces ingrÃ©dients : ${ingredientsTexte}.

Fournis UNIQUEMENT un JSON avec cette structure exacte (pas de texte avant ou aprÃ¨s) :
{
  "titre": "Nom de la recette",
  "temps": "Temps de prÃ©paration",
  "difficulte": "Facile/Moyen/Difficile",
  "etapes": ["Ã©tape 1", "Ã©tape 2", "etc."]
}`
                    }]
                })
            });

            const data = await response.json();
            const texte = data.content[0].text;
            const jsonMatch = texte.match(/\{[\s\S]*\}/);
            
            if (jsonMatch) {
                return JSON.parse(jsonMatch[0]);
            }
            
            throw new Error("Format de rÃ©ponse invalide");
        }

        function formaterRecette(recette, titre) {
            return `
                <div class="recipe-card">
                    <h4>ğŸ‘¨â€ğŸ³ ${titre} : ${recette.titre}</h4>
                    <div style="display: flex; gap: 20px; margin: 10px 0; color: #6b7280;">
                        <span>â±ï¸ ${recette.temps}</span>
                        <span>ğŸ“Š ${recette.difficulte}</span>
                    </div>
                    <div class="recipe-steps">
                        <h5>ğŸ“ Ã‰tapes de prÃ©paration</h5>
                        <ol>
                            ${recette.etapes.map(etape => `<li>${etape}</li>`).join('')}
                        </ol>
                    </div>
                </div>
            `;
        }
/* ---------------------------------------------------------
   âœ… AFFICHAGE DES RECETTES + FILTRES IdÃ©es Recettes
--------------------------------------------------------- */

function ouvrirRecettes() {
    afficherRecettes();
    document.getElementById('recettesModal').classList.add('active');
}

function afficherRecettes(filtre = "tous") {
    const container = document.getElementById("recettesContent");

    let recettesAffichees = RECETTES;

    if (filtre !== "tous") {
        recettesAffichees = RECETTES.filter(r => r.tags.includes(filtre));
    }

    if (recettesAffichees.length === 0) {
        container.innerHTML = `
            <div class="empty-state">Aucune recette pour ce filtre ğŸ˜•</div>
        `;
        return;
    }

    container.innerHTML = `
        <div class="recipe-grid">
            ${recettesAffichees.map(r =>
                `<div class="recipe-suggestion" onclick="afficherDetailRecette('${r.id}')">
                    <h4>${r.titre}</h4>
                    <div class="recipe-tags">
                        ${r.tags.map(t => `<span class="recipe-tag">${t}</span>`).join("")}
                    </div>
                </div>`
            ).join("")}
        </div>
    `;
}

function filtrerRecettes(type) {
    document.querySelectorAll(".filter-chip").forEach(btn => btn.classList.remove("active"));
    document.querySelector(`[data-filter="${type}"]`).classList.add("active");
    afficherRecettes(type);
}

function afficherDetailRecette(id) {
    const recette = RECETTES.find(r => r.id === id);
    if (!recette) return;

    document.getElementById("recetteDetailTitre").innerText = recette.titre;

    document.getElementById("recetteDetailContent").innerHTML = `
        <div class="recipe-meta">
            <span>â±ï¸ ${recette.temps}</span>
            <span>ğŸ“Š ${recette.difficulte}</span>
            <span>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Portions : ${recette.portions}</span>
        </div>
        <div class="recipe-ingredients">
            <h5>ğŸ›’ IngrÃ©dients</h5>
            <ul>${recette.ingredients.map(i => `<li>${i}</li>`).join("")}</ul>
        </div>
        <div class="recipe-steps">
            <h5>ğŸ§‘â€ğŸ³ Ã‰tapes</h5>
            <ol>${recette.etapes.map(e => `<li>${e}</li>`).join("")}</ol>
        </div>
        <div class="recipe-tip">${recette.conseil}</div>
    `;

    document.getElementById("recetteDetailModal").classList.add("active");
}
        function fermerModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function sauvegarderDansLocalStorage() {
            localStorage.setItem('monRegimeData', JSON.stringify({
                menus,
                stock,
                envies,
                recettesSemaine,
                recettesJour
            }));
        }

        function chargerDepuisLocalStorage() {
            const saved = localStorage.getItem('monRegimeData');
            if (saved) {
                const data = JSON.parse(saved);
                menus = data.menus || menus;
                stock = data.stock || {};
                envies = data.envies || [];
                recettesSemaine = data.recettesSemaine || {};
                recettesJour = data.recettesJour || {};
            }
        }

        function exporterPDF() {
            const courses = {};

            JOURS.forEach(jour => {
                REPAS.forEach(repas => {
                    menus[jour][repas].forEach(item => {
                        if (courses[item.nom]) {
                            courses[item.nom] += item.quantite;
                        } else {
                            courses[item.nom] = item.quantite;
                        }
                    });
                });
            });

            Object.keys(stock).forEach(aliment => {
                if (courses[aliment]) {
                    const alimentData = ALIMENTS[aliment];
                    const quantiteEnStock = stock[aliment] * alimentData.quantite;
                    courses[aliment] = Math.max(0, courses[aliment] - quantiteEnStock);
                    if (courses[aliment] === 0) {
                        delete courses[aliment];
                    }
                }
            });

            let contenu = 'ğŸ›’ LISTE DE COURSES\n';
            contenu += '===================\n\n';

            Object.entries(courses).sort((a, b) => a[0].localeCompare(b[0])).forEach(([nom, quantite]) => {
                const aliment = ALIMENTS[nom];
                contenu += `â˜ ${quantite} ${aliment.unite} ${nom}\n`;
            });

            contenu += '\n\nğŸ“¦ EN STOCK\n';
            contenu += '===================\n';
            Object.entries(stock).forEach(([nom, quantite]) => {
                const aliment = ALIMENTS[nom];
                contenu += `âœ“ ${quantite} Ã— ${aliment.quantite}${aliment.unite} ${nom}\n`;
            });

            contenu += '\n\nğŸ“Š STATISTIQUES\n';
            contenu += '===================\n';
            contenu += `Total semaine: ${calculerTotalSemaine()} kcal\n`;
            contenu += `Moyenne/jour: ${Math.round(calculerTotalSemaine() / 7)} kcal\n\n`;

            contenu += 'ğŸ“… MENUS DE LA SEMAINE\n';
            contenu += '===================\n\n';

            JOURS.forEach(jour => {
                contenu += `${jour} (${calculerTotalJour(jour)} kcal)\n`;
                contenu += '-'.repeat(30) + '\n';
                REPAS.forEach(repas => {
                    contenu += `  ${repas}:\n`;
                    menus[jour][repas].forEach(item => {
                        const aliment = ALIMENTS[item.nom];
                        contenu += `    - ${item.quantite}${aliment.unite} ${item.nom}\n`;
                    });
                });
                contenu += '\n';
            });

            // Ajouter les recettes si disponibles
            if (Object.keys(recettesSemaine).length > 0) {
                contenu += '\nğŸ‘¨â€ğŸ³ RECETTES DE LA SEMAINE\n';
                contenu += '===================\n\n';
                
                JOURS.forEach(jour => {
                    if (recettesSemaine[jour]) {
                        contenu += `${jour}\n`;
                        contenu += '-'.repeat(30) + '\n';
                        REPAS.forEach(repas => {
                            if (recettesSemaine[jour][repas]) {
                                const r = recettesSemaine[jour][repas];
                                contenu += `\n${repas}: ${r.titre}\n`;
                                contenu += `â±ï¸ ${r.temps} | ğŸ“Š ${r.difficulte}\n`;
                                contenu += 'Ã‰tapes:\n';
                                r.etapes.forEach((etape, i) => {
                                    contenu += `  ${i + 1}. ${etape}\n`;
                                });
                                contenu += '\n';
                            }
                        });
                        contenu += '\n';
                    }
                });
            }

            const blob = new Blob([contenu], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'mon-regime-semaine.txt';
            a.click();
            URL.revokeObjectURL(url);

            alert('ğŸ“„ Fichier exportÃ© avec succÃ¨s !');
        }

        // Fermer les modales en cliquant Ã  l'extÃ©rieur
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
            }
        }
</script>
	<!-- IA locale TinyLlama -->
<!-- ==================== SCRIPT FINAL ==================== -->
<script>
/* --- Initialisation aprÃ¨s chargement complet --- */
document.addEventListener("DOMContentLoaded", () => {
  try {
    initialiser();
    console.log("âœ… Mon RÃ©gime initialisÃ© avec succÃ¨s.");
  } catch (err) {
    console.error("Erreur lors de l'initialisation :", err);
  }
});

/* --- Sauvegarde automatique des menus --- */
function sauvegarderMenus() {
  try {
    localStorage.setItem("menus", JSON.stringify(menus));
    console.log("ğŸ’¾ Menus sauvegardÃ©s automatiquement");
  } catch (err) {
    console.warn("Erreur lors de la sauvegarde :", err);
  }
}

/* --- Rechargement automatique au dÃ©marrage --- */
function rechargerMenus() {
  const saved = localStorage.getItem("menus");
  if (saved) {
    try {
      menus = JSON.parse(saved);
      console.log("â™»ï¸ Menus rechargÃ©s depuis le stockage local");
    } catch {
      console.warn("Impossible de recharger les menus sauvegardÃ©s.");
    }
  }
}

/* --- Surveille les changements dans le menu pour auto-sauvegarder --- */
const observer = new MutationObserver(() => {
  sauvegarderMenus();
});
observer.observe(document.body, { childList: true, subtree: true });

/* --- Appel initial du rechargement --- */
rechargerMenus();

/* --- EmpÃªche le code IA local (Transformers/TinyLlama) --- */
// Si des scripts importent Transformers ou TinyLlama, on les ignore
window.addEventListener("error", (e) => {
  if (String(e.filename).includes("transformers") || String(e.message).includes("TinyLlama")) {
    e.preventDefault();
    console.log("ğŸš« Scripts IA locaux ignorÃ©s (gÃ©rÃ©s par server.js)");
  }
});
</script>
<script>
async function genRecetteIA(jour, repas) {
  // ğŸ§© VÃ©rifie et initialise la structure du menu
  if (!menus) menus = {};
  if (!menus[jour]) menus[jour] = {};
  if (!menus[jour][repas]) menus[jour][repas] = [];

  const items = menus[jour][repas];

  // âš ï¸ Si aucun aliment nâ€™est ajoutÃ©
  if (!Array.isArray(items) || items.length === 0) {
    alert("âš ï¸ Ce repas ne contient aucun aliment. Glissez-en depuis la liste avant de demander une recette IA.");
    return;
  }

  // ğŸ§¾ Construit la liste des ingrÃ©dients
  const ingredients = items.map(it => {
    const aliment = ALIMENTS[it.nom];
    if (!aliment) return it.nom;
    return `${it.quantite}${aliment.unite} de ${it.nom}`;
  }).join(', ');

  // ğŸ¬ PrÃ©pare la modale
  const titreEl = document.getElementById('recetteTitre');
  const contenuEl = document.getElementById('recetteContent');
  const modalEl = document.getElementById('recetteModal');

  if (!titreEl || !contenuEl || !modalEl) {
    alert("âš ï¸ La fenÃªtre de recette IA est introuvable dans cette page.");
    return;
  }

  titreEl.innerText = `Recette IA â€” ${jour} / ${repas}`;
  contenuEl.innerHTML = '<p>â³ GÃ©nÃ©ration de la recette en cours...</p>';
  modalEl.classList.add('active');

  // ğŸ“¡ Appel au serveur local (Node.js)
  try {
    const resp = await fetch('/api/gen_recette', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ jour, repas, ingredients })
    });

    const data = await resp.json();

    if (!resp.ok || !data || data.error) {
      contenuEl.innerHTML = `<div class="empty-state">âŒ Erreur : ${data.error || 'RÃ©ponse invalide du serveur.'}</div>`;
      return;
    }

    // ğŸ§‘â€ğŸ³ Affiche la recette gÃ©nÃ©rÃ©e
    contenuEl.innerHTML = `
      <div class="recipe-card">
        <h4>${data.titre || 'Recette IA'}</h4>
        <div>â±ï¸ ${data.temps || 'Temps inconnu'} â€¢ ${data.difficulte || 'Facile'}</div>
        <h5 style="margin-top:8px">Ã‰tapes</h5>
        <ol>${(data.etapes || []).map(e => `<li>${e}</li>`).join('')}</ol>
      </div>`;
  } catch (err) {
    console.error('Erreur rÃ©seau ou IA :', err);
    contenuEl.innerHTML = '<div class="empty-state">âŒ Erreur de connexion au serveur IA.</div>';
  }
}
</script>
<!-- Modal Recette IA -->
<div id="recetteModal" class="modal">
  <div class="modal-content">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
      <h3 id="recetteTitre">Recette IA</h3>
      <button onclick="fermerModal()">Fermer</button>
    </div>
    <div id="recetteContent"></div>
  </div>
</div>
</body>
</html>
